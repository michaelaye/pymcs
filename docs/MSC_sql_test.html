---

title: Title


keywords: fastai
sidebar: home_sidebar



nb_path: "notebooks/MSC_sql_test.ipynb"
---
<!--

#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: notebooks/MSC_sql_test.ipynb
# command to build the docs after a change: nbdev_build_docs

-->

<div class="container" id="notebook-container">
        
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">pymcs.db_tools</span> <span class="kn">import</span> <span class="n">MCSDB</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># it will automatically connect to the database and keep the connection alive:</span>
<span class="n">db</span> <span class="o">=</span> <span class="n">MCSDB</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">db</span><span class="o">.</span><span class="n">con</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>&lt;cx_Oracle.Connection to mcs_user@dmz-oracle-db-mcs-vm.pdmz.lasp.colorado.edu:1521/mcs-db&gt;</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">db</span><span class="o">.</span><span class="n">example_sql</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>&#39;select temperature from mcs_profile_data\n    where obsdate = 20070101 and obstime = 14486.727\n    &#39;</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">db</span><span class="o">.</span><span class="n">profile_columns</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>Index([&#39;ALTITUDE&#39;, &#39;ALTSURFACETA1&#39;, &#39;ALTSURFACETA4&#39;, &#39;ALTSURFACETA5&#39;,
       &#39;ALTSURFTA1ERROR&#39;, &#39;ALTSURFTA4ERROR&#39;, &#39;ALTSURFTA5ERROR&#39;, &#39;AZIMUTH&#39;,
       &#39;CO2ICE&#39;, &#39;CO2ICEQUAL&#39;, &#39;CO2ICE_ERR&#39;, &#39;CO2ICE_XXX_NAD_OD&#39;,
       &#39;CO2ICE_XXX_NAD_OD_ERR&#39;, &#39;DUST&#39;, &#39;DUSTQUAL&#39;, &#39;DUST_463_NAD_OD&#39;,
       &#39;DUST_463_NAD_OD_ERR&#39;, &#39;DUST_ERR&#39;, &#39;ELEVATION&#39;, &#39;FILENAME&#39;, &#39;H2OCOLUMN&#39;,
       &#39;H2OCOLUMNERROR&#39;, &#39;H2OICE&#39;, &#39;H2OICEQUAL&#39;, &#39;H2OICE_843_NAD_OD&#39;,
       &#39;H2OICE_843_NAD_OD_ERR&#39;, &#39;H2OICE_ERR&#39;, &#39;H2OINTCOLUMN&#39;, &#39;H2OQUAL&#39;,
       &#39;H2OSATALTITUDE&#39;, &#39;H2OVAP&#39;, &#39;H2OVAP_ERR&#39;, &#39;LATITUDE&#39;, &#39;LIMBANGLE&#39;,
       &#39;LOCALTIME&#39;, &#39;LONGITUDE&#39;, &#39;LS&#39;, &#39;MARSRADIUS&#39;, &#39;NADIRALTITUDE&#39;,
       &#39;NADIRAZIMUTH&#39;, &#39;NADIRDATE&#39;, &#39;NADIRELEVATION&#39;, &#39;NADIRLATITUDE&#39;,
       &#39;NADIRLOCALTIME&#39;, &#39;NADIRLONGITUDE&#39;, &#39;NADIRLS&#39;, &#39;NADIRRADIUS&#39;,
       &#39;NADIRROTATIONANGLE&#39;, &#39;NADIRSCLATITUDE&#39;, &#39;NADIRSCLK&#39;,
       &#39;NADIRSCLONGITUDE&#39;, &#39;NADIRSCRADIUS&#39;, &#39;NADIRSOLARLAT&#39;, &#39;NADIRSOLARLON&#39;,
       &#39;NADIRSZA&#39;, &#39;NADIRTIME&#39;, &#39;NEARSURFACET&#39;, &#39;NEARSURFACETERROR&#39;,
       &#39;NEARSURFACETGUESS&#39;, &#39;NLIMB&#39;, &#39;NNADIR&#39;, &#39;OBSDATE&#39;, &#39;OBSTIME&#39;,
       &#39;PARAMETERA&#39;, &#39;PARAMETERB&#39;, &#39;PARAMETERC&#39;, &#39;PARAMETERD&#39;, &#39;PRESSURE&#39;,
       &#39;PRESSUREQUAL&#39;, &#39;PROCESSED_DATE&#39;, &#39;RETRIEVALQUAL&#39;, &#39;RETRIEVEDPALTITUDE&#39;,
       &#39;RETRIEVEDPERROR&#39;, &#39;RETRIEVEDPRESSURE&#39;, &#39;ROW_NUM&#39;, &#39;SCENEALTITUDE&#39;,
       &#39;SCENEAREOIDRADIUS&#39;, &#39;SCENELATITUDE&#39;, &#39;SCENELONGITUDE&#39;, &#39;SCENERADIUS&#39;,
       &#39;SCENESURFACERADIUS&#39;, &#39;SCLK&#39;, &#39;SOLARLATITUDE&#39;, &#39;SOLARLONGITUDE&#39;,
       &#39;SPACECRAFTLATITUDE&#39;, &#39;SPACECRAFTLONGITUDE&#39;, &#39;SPACECRAFTRADIUS&#39;,
       &#39;SURFACEPGUESS&#39;, &#39;SURFACEPRESSURE&#39;, &#39;SURFACEPUNCERTAINTY&#39;,
       &#39;SURFACETEMPERATURE&#39;, &#39;SURFACETERROR&#39;, &#39;SURFACETGUESS&#39;, &#39;SZA&#39;,
       &#39;TEMPERATURE&#39;, &#39;TEMPERATUREQUAL&#39;, &#39;TEMP_ERR&#39;, &#39;TNADIR&#39;, &#39;VERSION&#39;],
      dtype=&#39;object&#39;)</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">db</span><span class="o">.</span><span class="n">profile_columns</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>Index([&#39;ALTITUDE&#39;, &#39;ALTSURFACETA1&#39;, &#39;ALTSURFACETA4&#39;, &#39;ALTSURFACETA5&#39;,
       &#39;ALTSURFTA1ERROR&#39;, &#39;ALTSURFTA4ERROR&#39;, &#39;ALTSURFTA5ERROR&#39;, &#39;AZIMUTH&#39;,
       &#39;CO2ICE&#39;, &#39;CO2ICEQUAL&#39;, &#39;CO2ICE_ERR&#39;, &#39;CO2ICE_XXX_NAD_OD&#39;,
       &#39;CO2ICE_XXX_NAD_OD_ERR&#39;, &#39;DUST&#39;, &#39;DUSTQUAL&#39;, &#39;DUST_463_NAD_OD&#39;,
       &#39;DUST_463_NAD_OD_ERR&#39;, &#39;DUST_ERR&#39;, &#39;ELEVATION&#39;, &#39;FILENAME&#39;, &#39;H2OCOLUMN&#39;,
       &#39;H2OCOLUMNERROR&#39;, &#39;H2OICE&#39;, &#39;H2OICEQUAL&#39;, &#39;H2OICE_843_NAD_OD&#39;,
       &#39;H2OICE_843_NAD_OD_ERR&#39;, &#39;H2OICE_ERR&#39;, &#39;H2OINTCOLUMN&#39;, &#39;H2OQUAL&#39;,
       &#39;H2OSATALTITUDE&#39;, &#39;H2OVAP&#39;, &#39;H2OVAP_ERR&#39;, &#39;LATITUDE&#39;, &#39;LIMBANGLE&#39;,
       &#39;LOCALTIME&#39;, &#39;LONGITUDE&#39;, &#39;LS&#39;, &#39;MARSRADIUS&#39;, &#39;NADIRALTITUDE&#39;,
       &#39;NADIRAZIMUTH&#39;, &#39;NADIRDATE&#39;, &#39;NADIRELEVATION&#39;, &#39;NADIRLATITUDE&#39;,
       &#39;NADIRLOCALTIME&#39;, &#39;NADIRLONGITUDE&#39;, &#39;NADIRLS&#39;, &#39;NADIRRADIUS&#39;,
       &#39;NADIRROTATIONANGLE&#39;, &#39;NADIRSCLATITUDE&#39;, &#39;NADIRSCLK&#39;,
       &#39;NADIRSCLONGITUDE&#39;, &#39;NADIRSCRADIUS&#39;, &#39;NADIRSOLARLAT&#39;, &#39;NADIRSOLARLON&#39;,
       &#39;NADIRSZA&#39;, &#39;NADIRTIME&#39;, &#39;NEARSURFACET&#39;, &#39;NEARSURFACETERROR&#39;,
       &#39;NEARSURFACETGUESS&#39;, &#39;NLIMB&#39;, &#39;NNADIR&#39;, &#39;OBSDATE&#39;, &#39;OBSTIME&#39;,
       &#39;PARAMETERA&#39;, &#39;PARAMETERB&#39;, &#39;PARAMETERC&#39;, &#39;PARAMETERD&#39;, &#39;PRESSURE&#39;,
       &#39;PRESSUREQUAL&#39;, &#39;PROCESSED_DATE&#39;, &#39;RETRIEVALQUAL&#39;, &#39;RETRIEVEDPALTITUDE&#39;,
       &#39;RETRIEVEDPERROR&#39;, &#39;RETRIEVEDPRESSURE&#39;, &#39;ROW_NUM&#39;, &#39;SCENEALTITUDE&#39;,
       &#39;SCENEAREOIDRADIUS&#39;, &#39;SCENELATITUDE&#39;, &#39;SCENELONGITUDE&#39;, &#39;SCENERADIUS&#39;,
       &#39;SCENESURFACERADIUS&#39;, &#39;SCLK&#39;, &#39;SOLARLATITUDE&#39;, &#39;SOLARLONGITUDE&#39;,
       &#39;SPACECRAFTLATITUDE&#39;, &#39;SPACECRAFTLONGITUDE&#39;, &#39;SPACECRAFTRADIUS&#39;,
       &#39;SURFACEPGUESS&#39;, &#39;SURFACEPRESSURE&#39;, &#39;SURFACEPUNCERTAINTY&#39;,
       &#39;SURFACETEMPERATURE&#39;, &#39;SURFACETERROR&#39;, &#39;SURFACETGUESS&#39;, &#39;SZA&#39;,
       &#39;TEMPERATURE&#39;, &#39;TEMPERATUREQUAL&#39;, &#39;TEMP_ERR&#39;, &#39;TNADIR&#39;, &#39;VERSION&#39;],
      dtype=&#39;object&#39;)</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">db</span><span class="o">.</span><span class="n">nadir_columns</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>Index([&#39;NLIMB&#39;, &#39;NNADIR&#39;, &#39;TNADIR&#39;, &#39;OBSDATE&#39;, &#39;OBSTIME&#39;, &#39;SCLK&#39;, &#39;LS&#39;,
       &#39;LOCALTIME&#39;, &#39;SZA&#39;, &#39;SOLARLATITUDE&#39;, &#39;SOLARLONGITUDE&#39;, &#39;ELEVATION&#39;,
       &#39;AZIMUTH&#39;, &#39;SPACECRAFTLATITUDE&#39;, &#39;SPACECRAFTLONGITUDE&#39;,
       &#39;SPACECRAFTRADIUS&#39;, &#39;LIMBANGLE&#39;, &#39;SCENELATITUDE&#39;, &#39;SCENELONGITUDE&#39;,
       &#39;SCENERADIUS&#39;, &#39;SCENEALTITUDE&#39;, &#39;NADIRDATE&#39;, &#39;NADIRTIME&#39;, &#39;NADIRSCLK&#39;,
       &#39;NADIRLS&#39;, &#39;NADIRLOCALTIME&#39;, &#39;NADIRSZA&#39;, &#39;NADIRSOLARLAT&#39;,
       &#39;NADIRSOLARLON&#39;, &#39;NADIRELEVATION&#39;, &#39;NADIRAZIMUTH&#39;, &#39;NADIRSCLATITUDE&#39;,
       &#39;NADIRSCLONGITUDE&#39;, &#39;NADIRSCRADIUS&#39;, &#39;NADIRROTATIONANGLE&#39;,
       &#39;NADIRLATITUDE&#39;, &#39;NADIRLONGITUDE&#39;, &#39;NADIRRADIUS&#39;, &#39;NADIRALTITUDE&#39;,
       &#39;SCENESURFACERADIUS&#39;, &#39;SCENEAREOIDRADIUS&#39;, &#39;MARSRADIUS&#39;,
       &#39;DUST_463_NAD_OD&#39;, &#39;DUST_463_NAD_OD_ERR&#39;, &#39;H2OICE_843_NAD_OD&#39;,
       &#39;H2OICE_843_NAD_OD_ERR&#39;, &#39;H2OCOLUMN&#39;, &#39;H2OCOLUMNERROR&#39;,
       &#39;CO2ICE_XXX_NAD_OD&#39;, &#39;CO2ICE_XXX_NAD_OD_ERR&#39;, &#39;SURFACETEMPERATURE&#39;,
       &#39;SURFACETERROR&#39;, &#39;SURFACETGUESS&#39;, &#39;NEARSURFACET&#39;, &#39;NEARSURFACETERROR&#39;,
       &#39;NEARSURFACETGUESS&#39;, &#39;SURFACEPRESSURE&#39;, &#39;SURFACEPUNCERTAINTY&#39;,
       &#39;SURFACEPGUESS&#39;, &#39;RETRIEVEDPALTITUDE&#39;, &#39;RETRIEVEDPRESSURE&#39;,
       &#39;RETRIEVEDPERROR&#39;, &#39;ALTSURFACETA1&#39;, &#39;ALTSURFTA1ERROR&#39;, &#39;ALTSURFACETA4&#39;,
       &#39;ALTSURFTA4ERROR&#39;, &#39;ALTSURFACETA5&#39;, &#39;ALTSURFTA5ERROR&#39;, &#39;H2OINTCOLUMN&#39;,
       &#39;H2OSATALTITUDE&#39;, &#39;PARAMETERA&#39;, &#39;PARAMETERB&#39;, &#39;PARAMETERC&#39;,
       &#39;PARAMETERD&#39;, &#39;PRESSUREQUAL&#39;, &#39;TEMPERATUREQUAL&#39;, &#39;DUSTQUAL&#39;,
       &#39;H2OICEQUAL&#39;, &#39;H2OQUAL&#39;, &#39;CO2ICEQUAL&#39;, &#39;RETRIEVALQUAL&#39;, &#39;FILENAME&#39;,
       &#39;PROCESSED_DATE&#39;, &#39;VERSION&#39;, &#39;ROW_NUM&#39;, &#39;CHANNEL&#39;, &#39;RADIANCE_MEASURED&#39;,
       &#39;RADIANCE_CALCULATED&#39;, &#39;ALTITUDE&#39;],
      dtype=&#39;object&#39;)</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">df</span> <span class="o">=</span> <span class="n">db</span><span class="o">.</span><span class="n">get_profile_cols_by_date</span><span class="p">([</span><span class="s2">&quot;pressure&quot;</span><span class="p">,</span> <span class="s2">&quot;temperature&quot;</span><span class="p">,</span> <span class="s2">&quot;obstime&quot;</span><span class="p">,</span> <span class="s2">&quot;altitude&quot;</span><span class="p">],</span> <span class="s2">&quot;20080101&quot;</span><span class="p">)</span>
<span class="n">df</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>Sending this request:
select pressure,temperature,obstime,altitude from mcs_profile_data where obsdate = 20080101
</pre>
</div>
</div>

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>PRESSURE</th>
      <th>TEMPERATURE</th>
      <th>OBSTIME</th>
      <th>ALTITUDE</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>0</td>
      <td>1878.932</td>
      <td>NaN</td>
      <td>31.232</td>
      <td>NaN</td>
    </tr>
    <tr>
      <td>1</td>
      <td>1658.152</td>
      <td>NaN</td>
      <td>31.232</td>
      <td>NaN</td>
    </tr>
    <tr>
      <td>2</td>
      <td>1463.314</td>
      <td>NaN</td>
      <td>31.232</td>
      <td>NaN</td>
    </tr>
    <tr>
      <td>3</td>
      <td>1291.370</td>
      <td>NaN</td>
      <td>31.232</td>
      <td>NaN</td>
    </tr>
    <tr>
      <td>4</td>
      <td>1139.630</td>
      <td>NaN</td>
      <td>31.232</td>
      <td>NaN</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">sql</span> <span class="o">=</span> <span class="s2">&quot;&quot;&quot;</span>
<span class="s2">select temperature, dust, latitude, longitude, obsdate</span>
<span class="s2">from mcs_profile_data</span>
<span class="s2">where pressure between 45 and 55</span>
<span class="s2">and obsdate between 20080830 and 20080920</span>
<span class="s2">&quot;&quot;&quot;</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">dg</span> <span class="o">=</span> <span class="n">db</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="n">sql</span><span class="p">)</span>
<span class="n">dg</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>TEMPERATURE</th>
      <th>DUST</th>
      <th>LATITUDE</th>
      <th>LONGITUDE</th>
      <th>OBSDATE</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>0</td>
      <td>172.334</td>
      <td>0.000022</td>
      <td>45.969</td>
      <td>-157.800</td>
      <td>20080830</td>
    </tr>
    <tr>
      <td>1</td>
      <td>174.031</td>
      <td>0.000559</td>
      <td>24.131</td>
      <td>-128.308</td>
      <td>20080830</td>
    </tr>
    <tr>
      <td>2</td>
      <td>170.915</td>
      <td>NaN</td>
      <td>22.567</td>
      <td>-128.536</td>
      <td>20080830</td>
    </tr>
    <tr>
      <td>3</td>
      <td>167.967</td>
      <td>NaN</td>
      <td>21.041</td>
      <td>-128.758</td>
      <td>20080830</td>
    </tr>
    <tr>
      <td>4</td>
      <td>169.668</td>
      <td>NaN</td>
      <td>19.421</td>
      <td>-128.986</td>
      <td>20080830</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

</div>
 

